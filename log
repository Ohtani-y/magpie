╔══════════════════════════════════════════════════════════╗
║              🧮 Magpie Math Dataset Generator              ║
║                   HLE Mathematics Edition                 ║
╚══════════════════════════════════════════════════════════╝

💡 ヒント: 引数を使って直接実行もできます:
   ./run_math_generation.sh 1 1.0 1      # DeepSeek-Qwen-32Bで全ドメイン標準倍率生成
   ./run_math_generation.sh 5 0.5 1      # Qwen-Math-72Bで全ドメイン0.5倍生成
   ./run_math_generation.sh 2 0.5 2 2    # DeepSeek-Llama-70Bで微積分0.5倍生成
   ./run_math_generation.sh -h           # 日本語ヘルプを表示

📝 Select Model:
1) DeepSeek-R1-Distill-Qwen-32B (Recommended - Balanced performance)
2) DeepSeek-R1-Distill-Llama-70B (High performance - Requires A100)
3) DeepSeek-R1-0528-FP4 (Memory efficient - FP4 quantized)
4) Gemma-3-27B-it (Google model)
5) Qwen2.5-Math-72B-Instruct (Math specialist)
6) Qwen2.5-Coder-32B-Instruct (Computational math focus)
8) Qwen2.5-3B-Instruct (Test model - Lightweight)

Enter choice (1-6,8): ^C
(magpie) [P12U022@osk-gpu85 scripts]$ ./run_math_generation.sh 8 0.01 1
Running in non-interactive mode
Model: 8, Scale: 0.01, Mode: 1


Selected: Qwen2.5 3B (Test)

生成倍率: 0.01x


🚀 Starting complete dataset generation...
Model: Qwen2.5 3B (Test)
生成倍率: 0.01x
Total problems: 440
Domains: Algebra (100), Calculus (100), Geometry (60), Statistics (60), Number Theory (40), Discrete (80)

🧮 Complete Math Domain Dataset Generator
==============================================
Configuration:
  Model: Qwen/Qwen2.5-3B-Instruct
  Total problems: 440
  Domains: statistics calculus geometry number_theory algebra discrete
  Base output directory: ../data/Qwen2.5-3B-Instruct_AllDomains_20250731_210126


🎯 Generating statistics dataset (60 problems)
Description: Probability theory, statistical inference, regression, data analysis
📝 Expected model: Qwen/Qwen2.5-3B-Instruct
📁 Expected folder pattern: Qwen2.5-3B-Instruct_statistics_*
🚀 Starting generation for statistics...
🧮 Domain-Specific Math Dataset Generator
==============================================
Configuration:
  Model: Qwen/Qwen2.5-3B-Instruct
  Domain: statistics
  Problem count: 60
  Output directory: ../data/Qwen2.5-3B-Instruct_statistics_20250731_210126

🎯 データセット生成を開始します
対象分野: ADVANCED STATISTICS - Measure-theoretic probability, advanced inference, martingales
生成問題数: 60 問
使用モデル: Qwen/Qwen2.5-3B-Instruct

[ステップ 1/4] 📝 数学問題の生成
  → statistics分野の問題を60問生成中...

⏳ 推定時間: 5-10分 (問題数により変動)
HLE数学推論データ生成マネージャー開始。引数: Namespace(model_path='Qwen/Qwen2.5-3B-Instruct', temperature=1.1, top_p=1.0, n=200, repeat=None, total_prompts=60, max_tokens=1024, max_model_len=4096, early_stopping=True, system_prompt=False, sanitize=False, logits_processor=False, flaming_tokens=False, control_tasks='math', domain='statistics', shuffle=True, skip_special_tokens=True, engine='vllm', device='0', dtype='bfloat16', tensor_parallel_size=1, gpu_memory_utilization=0.95, swap_space=2.0, checkpoint_every=100, output_folder='../data', save_path='../data/Qwen2.5-3B-Instruct_statistics_20250731_210126/statistics_ins.json', job_name=None, timestamp=1753963296, seed=None)
INFO 07-31 21:01:50 config.py:478] This model supports multiple tasks: {'generate', 'score', 'classify', 'reward', 'embed'}. Defaulting to 'generate'.
INFO 07-31 21:01:50 llm_engine.py:249] Initializing an LLM engine (v0.6.5) with config: model='Qwen/Qwen2.5-3B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-3B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=1753963296, served_model_name=Qwen/Qwen2.5-3B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=False, use_async_output_proc=True, mm_cache_preprocessor=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False,
INFO 07-31 21:01:52 selector.py:120] Using Flash Attention backend.
INFO 07-31 21:01:52 model_runner.py:1092] Starting to load model Qwen/Qwen2.5-3B-Instruct...
INFO 07-31 21:01:52 weight_utils.py:243] Using model weights format ['*.safetensors']
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.65s/it]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.27s/it]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.33s/it]

INFO 07-31 21:01:56 model_runner.py:1097] Loading model weights took 5.7915 GB
INFO 07-31 21:01:56 worker.py:241] Memory profiling takes 0.44 seconds
INFO 07-31 21:01:56 worker.py:241] the current vLLM instance can use total_gpu_memory (79.44GiB) x gpu_memory_utilization (0.95) = 75.47GiB
INFO 07-31 21:01:56 worker.py:241] model weights take 5.79GiB; non_torch_memory takes 0.25GiB; PyTorch activation peak memory takes 1.42GiB; the rest of the memory reserved for KV Cache is 68.00GiB.
INFO 07-31 21:01:56 gpu_executor.py:76] # GPU blocks: 123797, # CPU blocks: 3640
INFO 07-31 21:01:56 gpu_executor.py:80] Maximum concurrency for 4096 tokens per request: 483.58x
INFO 07-31 21:01:57 model_runner.py:1413] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 07-31 21:01:57 model_runner.py:1417] If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 07-31 21:02:05 model_runner.py:1527] Graph capturing finished in 8 secs, took 0.29 GiB
INFO 07-31 21:02:05 llm_engine.py:446] init engine (profile, create kv cache, warmup model) took 9.23 seconds
✅ モデル設定を正常に読み込みました: Qwen/Qwen2.5-3B-Instruct
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/Competition2025/P12/P12U022/magpie/scripts/../exp/gen_ins.py", line 288, in <module>
[rank0]:     main()
[rank0]:   File "/home/Competition2025/P12/P12U022/magpie/scripts/../exp/gen_ins.py", line 192, in main
[rank0]:     stop=stop_tokens,
[rank0]: UnboundLocalError: local variable 'stop_tokens' referenced before assignment
[rank0]:[W731 21:02:09.699574414 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
❌ Error: Failed to generate statistics dataset
🚫 Stopping execution to prevent incorrect folder processing
(magpie) [P12U022@osk-gpu85 scripts]$ ./run_math_generation.sh 1 0.01 1
Running in non-interactive mode
Model: 1, Scale: 0.01, Mode: 1


Selected: DeepSeek R1 Distill Qwen 32B

生成倍率: 0.01x


🚀 Starting complete dataset generation...
Model: DeepSeek R1 Distill Qwen 32B
生成倍率: 0.01x
Total problems: 440
Domains: Algebra (100), Calculus (100), Geometry (60), Statistics (60), Number Theory (40), Discrete (80)

🧮 Complete Math Domain Dataset Generator
==============================================
Configuration:
  Model: deepseek-ai/DeepSeek-R1-Distill-Qwen-32B
  Total problems: 440
  Domains: statistics calculus geometry number_theory algebra discrete
  Base output directory: ../data/DeepSeek-R1-Distill-Qwen-32B_AllDomains_20250731_210313


🎯 Generating statistics dataset (60 problems)
Description: Probability theory, statistical inference, regression, data analysis
📝 Expected model: deepseek-ai/DeepSeek-R1-Distill-Qwen-32B
📁 Expected folder pattern: DeepSeek-R1-Distill-Qwen-32B_statistics_*
🚀 Starting generation for statistics...
🧮 Domain-Specific Math Dataset Generator
==============================================
Configuration:
  Model: deepseek-ai/DeepSeek-R1-Distill-Qwen-32B
  Domain: statistics
  Problem count: 60
  Output directory: ../data/DeepSeek-R1-Distill-Qwen-32B_statistics_20250731_210313

🎯 データセット生成を開始します
対象分野: ADVANCED STATISTICS - Measure-theoretic probability, advanced inference, martingales
生成問題数: 60 問
使用モデル: deepseek-ai/DeepSeek-R1-Distill-Qwen-32B

[ステップ 1/4] 📝 数学問題の生成
  → statistics分野の問題を60問生成中...

⏳ 推定時間: 5-10分 (問題数により変動)
HLE数学推論データ生成マネージャー開始。引数: Namespace(model_path='deepseek-ai/DeepSeek-R1-Distill-Qwen-32B', temperature=1.1, top_p=1.0, n=200, repeat=None, total_prompts=60, max_tokens=1024, max_model_len=4096, early_stopping=True, system_prompt=False, sanitize=False, logits_processor=False, flaming_tokens=False, control_tasks='math', domain='statistics', shuffle=True, skip_special_tokens=True, engine='vllm', device='0', dtype='bfloat16', tensor_parallel_size=1, gpu_memory_utilization=0.95, swap_space=2.0, checkpoint_every=100, output_folder='../data', save_path='../data/DeepSeek-R1-Distill-Qwen-32B_statistics_20250731_210313/statistics_ins.json', job_name=None, timestamp=1753963404, seed=None)
INFO 07-31 21:03:38 config.py:478] This model supports multiple tasks: {'classify', 'score', 'embed', 'generate', 'reward'}. Defaulting to 'generate'.
INFO 07-31 21:03:38 llm_engine.py:249] Initializing an LLM engine (v0.6.5) with config: model='deepseek-ai/DeepSeek-R1-Distill-Qwen-32B', speculative_config=None, tokenizer='deepseek-ai/DeepSeek-R1-Distill-Qwen-32B', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=1753963404, served_model_name=deepseek-ai/DeepSeek-R1-Distill-Qwen-32B, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=False, use_async_output_proc=True, mm_cache_preprocessor=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False,
INFO 07-31 21:03:40 selector.py:120] Using Flash Attention backend.
INFO 07-31 21:03:40 model_runner.py:1092] Starting to load model deepseek-ai/DeepSeek-R1-Distill-Qwen-32B...
INFO 07-31 21:03:41 weight_utils.py:243] Using model weights format ['*.safetensors']
Loading safetensors checkpoint shards:   0% Completed | 0/8 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  12% Completed | 1/8 [00:02<00:16,  2.29s/it]
Loading safetensors checkpoint shards:  25% Completed | 2/8 [00:07<00:23,  3.93s/it]
Loading safetensors checkpoint shards:  38% Completed | 3/8 [00:12<00:22,  4.54s/it]
Loading safetensors checkpoint shards:  50% Completed | 4/8 [00:17<00:19,  4.85s/it]
Loading safetensors checkpoint shards:  62% Completed | 5/8 [00:23<00:14,  4.99s/it]
Loading safetensors checkpoint shards:  75% Completed | 6/8 [00:28<00:10,  5.07s/it]
Loading safetensors checkpoint shards:  88% Completed | 7/8 [00:33<00:05,  5.12s/it]
Loading safetensors checkpoint shards: 100% Completed | 8/8 [00:38<00:00,  5.15s/it]
Loading safetensors checkpoint shards: 100% Completed | 8/8 [00:38<00:00,  4.86s/it]

INFO 07-31 21:04:20 model_runner.py:1097] Loading model weights took 61.0607 GB
INFO 07-31 21:04:21 worker.py:241] Memory profiling takes 0.80 seconds
INFO 07-31 21:04:21 worker.py:241] the current vLLM instance can use total_gpu_memory (79.44GiB) x gpu_memory_utilization (0.95) = 75.47GiB
INFO 07-31 21:04:21 worker.py:241] model weights take 61.06GiB; non_torch_memory takes 0.17GiB; PyTorch activation peak memory takes 1.45GiB; the rest of the memory reserved for KV Cache is 12.78GiB.
INFO 07-31 21:04:21 gpu_executor.py:76] # GPU blocks: 3272, # CPU blocks: 512
INFO 07-31 21:04:21 gpu_executor.py:80] Maximum concurrency for 4096 tokens per request: 12.78x
INFO 07-31 21:04:22 model_runner.py:1413] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 07-31 21:04:22 model_runner.py:1417] If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 07-31 21:04:32 model_runner.py:1527] Graph capturing finished in 10 secs, took 0.42 GiB
INFO 07-31 21:04:32 llm_engine.py:446] init engine (profile, create kv cache, warmup model) took 11.36 seconds
✅ モデル設定を正常に読み込みました: deepseek-ai/DeepSeek-R1-Distill-Qwen-32B
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/Competition2025/P12/P12U022/magpie/scripts/../exp/gen_ins.py", line 288, in <module>
[rank0]:     main()
[rank0]:   File "/home/Competition2025/P12/P12U022/magpie/scripts/../exp/gen_ins.py", line 192, in main
[rank0]:     stop=stop_tokens,
[rank0]: UnboundLocalError: local variable 'stop_tokens' referenced before assignment
[rank0]:[W731 21:04:32.577553410 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
❌ Error: Failed to generate statistics dataset
🚫 Stopping execution to prevent incorrect folder processing
(magpie) [P12U022@osk-gpu85 scripts]$ ./run_math_generation.sh 1 0.01 1
Running in non-interactive mode
Model: 1, Scale: 0.01, Mode: 1


Selected: DeepSeek R1 Distill Qwen 32B

生成倍率: 0.01x


🚀 Starting complete dataset generation...
Model: DeepSeek R1 Distill Qwen 32B
生成倍率: 0.01x
Total problems: 440
Domains: Algebra (100), Calculus (100), Geometry (60), Statistics (60), Number Theory (40), Discrete (80)

🧮 Complete Math Domain Dataset Generator
==============================================
Configuration:
  Model: deepseek-ai/DeepSeek-R1-Distill-Qwen-32B
  Total problems: 440
  Domains: statistics calculus geometry number_theory algebra discrete
  Base output directory: ../data/DeepSeek-R1-Distill-Qwen-32B_AllDomains_20250731_212646


🎯 Generating statistics dataset (60 problems)
Description: Probability theory, statistical inference, regression, data analysis
📝 Expected model: deepseek-ai/DeepSeek-R1-Distill-Qwen-32B
📁 Expected folder pattern: DeepSeek-R1-Distill-Qwen-32B_statistics_*
🚀 Starting generation for statistics...
🧮 Domain-Specific Math Dataset Generator
==============================================
Configuration:
  Model: deepseek-ai/DeepSeek-R1-Distill-Qwen-32B
  Domain: statistics
  Problem count: 60
  Output directory: ../data/DeepSeek-R1-Distill-Qwen-32B_statistics_20250731_212646

🎯 データセット生成を開始します
対象分野: ADVANCED STATISTICS - Measure-theoretic probability, advanced inference, martingales
生成問題数: 60 問
使用モデル: deepseek-ai/DeepSeek-R1-Distill-Qwen-32B

[ステップ 1/4] 📝 数学問題の生成
  → statistics分野の問題を60問生成中...

⏳ 推定時間: 5-10分 (問題数により変動)
HLE数学推論データ生成マネージャー開始。引数: Namespace(model_path='deepseek-ai/DeepSeek-R1-Distill-Qwen-32B', temperature=1.1, top_p=1.0, n=200, repeat=None, total_prompts=60, max_tokens=1024, max_model_len=4096, early_stopping=True, system_prompt=False, sanitize=False, logits_processor=False, flaming_tokens=False, control_tasks='math', domain='statistics', shuffle=True, skip_special_tokens=True, engine='vllm', device='0', dtype='bfloat16', tensor_parallel_size=1, gpu_memory_utilization=0.95, swap_space=2.0, checkpoint_every=100, output_folder='../data', save_path='../data/DeepSeek-R1-Distill-Qwen-32B_statistics_20250731_212646/statistics_ins.json', job_name=None, timestamp=1753964818, seed=None)
INFO 07-31 21:27:12 config.py:478] This model supports multiple tasks: {'reward', 'generate', 'embed', 'score', 'classify'}. Defaulting to 'generate'.
INFO 07-31 21:27:12 llm_engine.py:249] Initializing an LLM engine (v0.6.5) with config: model='deepseek-ai/DeepSeek-R1-Distill-Qwen-32B', speculative_config=None, tokenizer='deepseek-ai/DeepSeek-R1-Distill-Qwen-32B', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=1753964818, served_model_name=deepseek-ai/DeepSeek-R1-Distill-Qwen-32B, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=False, use_async_output_proc=True, mm_cache_preprocessor=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False,
INFO 07-31 21:27:14 selector.py:120] Using Flash Attention backend.
INFO 07-31 21:27:14 model_runner.py:1092] Starting to load model deepseek-ai/DeepSeek-R1-Distill-Qwen-32B...
INFO 07-31 21:27:15 weight_utils.py:243] Using model weights format ['*.safetensors']
Loading safetensors checkpoint shards:   0% Completed | 0/8 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  12% Completed | 1/8 [00:02<00:16,  2.32s/it]
Loading safetensors checkpoint shards:  25% Completed | 2/8 [00:05<00:18,  3.07s/it]
Loading safetensors checkpoint shards:  38% Completed | 3/8 [00:10<00:19,  3.98s/it]
Loading safetensors checkpoint shards:  50% Completed | 4/8 [00:16<00:17,  4.48s/it]
Loading safetensors checkpoint shards:  62% Completed | 5/8 [00:19<00:12,  4.18s/it]
Loading safetensors checkpoint shards:  75% Completed | 6/8 [00:23<00:07,  3.99s/it]
Loading safetensors checkpoint shards:  88% Completed | 7/8 [00:28<00:04,  4.31s/it]
Loading safetensors checkpoint shards: 100% Completed | 8/8 [00:32<00:00,  4.09s/it]
Loading safetensors checkpoint shards: 100% Completed | 8/8 [00:32<00:00,  4.01s/it]

INFO 07-31 21:27:48 model_runner.py:1097] Loading model weights took 61.0607 GB
INFO 07-31 21:27:49 worker.py:241] Memory profiling takes 0.93 seconds
INFO 07-31 21:27:49 worker.py:241] the current vLLM instance can use total_gpu_memory (79.44GiB) x gpu_memory_utilization (0.95) = 75.47GiB
INFO 07-31 21:27:49 worker.py:241] model weights take 61.06GiB; non_torch_memory takes 0.17GiB; PyTorch activation peak memory takes 1.45GiB; the rest of the memory reserved for KV Cache is 12.78GiB.
INFO 07-31 21:27:49 gpu_executor.py:76] # GPU blocks: 3272, # CPU blocks: 512
INFO 07-31 21:27:49 gpu_executor.py:80] Maximum concurrency for 4096 tokens per request: 12.78x
INFO 07-31 21:27:50 model_runner.py:1413] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 07-31 21:27:50 model_runner.py:1417] If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 07-31 21:27:59 model_runner.py:1527] Graph capturing finished in 10 secs, took 0.42 GiB
INFO 07-31 21:27:59 llm_engine.py:446] init engine (profile, create kv cache, warmup model) took 11.56 seconds
✅ モデル設定を正常に読み込みました: deepseek-ai/DeepSeek-R1-Distill-Qwen-32B
[rank0]: Traceback (most recent call last):
[rank0]:   File "/home/Competition2025/P12/P12U022/magpie/scripts/../exp/gen_ins.py", line 288, in <module>
[rank0]:     main()
[rank0]:   File "/home/Competition2025/P12/P12U022/magpie/scripts/../exp/gen_ins.py", line 192, in main
[rank0]:     stop=stop_tokens,
[rank0]: UnboundLocalError: local variable 'stop_tokens' referenced before assignment
[rank0]:[W731 21:28:00.155533159 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
❌ Error: Failed to generate statistics dataset
🚫 Stopping execution to prevent incorrect folder processing
(magpie) [P12U022@osk-gpu85 scripts]$ ./run_math_generation.sh 8 0.01 1
Running in non-interactive mode
Model: 8, Scale: 0.01, Mode: 1


Selected: Qwen2.5 3B (Test)

生成倍率: 0.01x


🚀 Starting complete dataset generation...
Model: Qwen2.5 3B (Test)
生成倍率: 0.01x
Total problems: 440
Domains: Algebra (100), Calculus (100), Geometry (60), Statistics (60), Number Theory (40), Discrete (80)

🧮 Complete Math Domain Dataset Generator
==============================================
Configuration:
  Model: Qwen/Qwen2.5-3B-Instruct
  Total problems: 440
  Domains: statistics calculus geometry number_theory algebra discrete
  Base output directory: ../data/Qwen2.5-3B-Instruct_AllDomains_20250731_212932


🎯 Generating statistics dataset (60 problems)
Description: Probability theory, statistical inference, regression, data analysis
📝 Expected model: Qwen/Qwen2.5-3B-Instruct
📁 Expected folder pattern: Qwen2.5-3B-Instruct_statistics_*
🚀 Starting generation for statistics...
🧮 Domain-Specific Math Dataset Generator
==============================================
Configuration:
  Model: Qwen/Qwen2.5-3B-Instruct
  Domain: statistics
  Problem count: 60
  Output directory: ../data/Qwen2.5-3B-Instruct_statistics_20250731_212932

🎯 データセット生成を開始します
対象分野: ADVANCED STATISTICS - Measure-theoretic probability, advanced inference, martingales
生成問題数: 60 問
使用モデル: Qwen/Qwen2.5-3B-Instruct

[ステップ 1/4] 📝 数学問題の生成
  → statistics分野の問題を60問生成中...

⏳ 推定時間: 5-10分 (問題数により変動)
HLE数学推論データ生成マネージャー開始。引数: Namespace(model_path='Qwen/Qwen2.5-3B-Instruct', temperature=1.1, top_p=1.0, n=200, repeat=None, total_prompts=60, max_tokens=1024, max_model_len=4096, early_stopping=True, system_prompt=False, sanitize=False, logits_processor=False, flaming_tokens=False, control_tasks='math', domain='statistics', shuffle=True, skip_special_tokens=True, engine='vllm', device='0', dtype='bfloat16', tensor_parallel_size=1, gpu_memory_utilization=0.95, swap_space=2.0, checkpoint_every=100, output_folder='../data', save_path='../data/Qwen2.5-3B-Instruct_statistics_20250731_212932/statistics_ins.json', job_name=None, timestamp=1753964982, seed=None)
INFO 07-31 21:29:57 config.py:478] This model supports multiple tasks: {'embed', 'score', 'classify', 'reward', 'generate'}. Defaulting to 'generate'.
INFO 07-31 21:29:57 llm_engine.py:249] Initializing an LLM engine (v0.6.5) with config: model='Qwen/Qwen2.5-3B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-3B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=1753964982, served_model_name=Qwen/Qwen2.5-3B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=False, use_async_output_proc=True, mm_cache_preprocessor=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False,
INFO 07-31 21:29:58 selector.py:120] Using Flash Attention backend.
INFO 07-31 21:29:59 model_runner.py:1092] Starting to load model Qwen/Qwen2.5-3B-Instruct...
INFO 07-31 21:29:59 weight_utils.py:243] Using model weights format ['*.safetensors']
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.74s/it]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.45s/it]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.49s/it]

INFO 07-31 21:30:03 model_runner.py:1097] Loading model weights took 5.7915 GB
INFO 07-31 21:30:03 worker.py:241] Memory profiling takes 0.46 seconds
INFO 07-31 21:30:03 worker.py:241] the current vLLM instance can use total_gpu_memory (79.44GiB) x gpu_memory_utilization (0.95) = 75.47GiB
INFO 07-31 21:30:03 worker.py:241] model weights take 5.79GiB; non_torch_memory takes 0.25GiB; PyTorch activation peak memory takes 1.42GiB; the rest of the memory reserved for KV Cache is 68.00GiB.
INFO 07-31 21:30:03 gpu_executor.py:76] # GPU blocks: 123797, # CPU blocks: 3640
INFO 07-31 21:30:03 gpu_executor.py:80] Maximum concurrency for 4096 tokens per request: 483.58x
INFO 07-31 21:30:04 model_runner.py:1413] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 07-31 21:30:04 model_runner.py:1417] If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 07-31 21:30:13 model_runner.py:1527] Graph capturing finished in 9 secs, took 0.29 GiB
INFO 07-31 21:30:13 llm_engine.py:446] init engine (profile, create kv cache, warmup model) took 10.14 seconds
✅ モデル設定を正常に読み込みました: Qwen/Qwen2.5-3B-Instruct
制御タスク: math (HLE数学対策特化)
ドメイン特化: statistics
事前クエリテンプレート: <|begin_of_text|><|start_header_id|>system<|end_header_id|>

You are an AI assistant specialized in Number Theory, the branch of pure mathematics devoted to the study of integers and their properties. Your role is to guide users through the fascinating world of numbers, from elementary concepts to advanced theorems, while fostering deep mathematical thinking and problem-solving skills.

Your expertise includes but is not limited to:
- Divisibility, primes, and the Fundamental Theorem of Arithmetic
- Modular arithmetic and congruences
- Diophantine equations
- Number-theoretic functions (Euler's totient, Möbius function, etc.)
- Quadratic residues and reciprocity
- Continued fractions
- Primitive roots and indices
- Distribution of prime numbers
- Analytic number theory basics
- Algebraic number theory fundamentals
- Computational number theory
- Applications in cryptography

When addressing number theory problems, you should:
1. Clearly state the problem in precise mathematical terms
2. Identify relevant number-theoretic concepts and theorems
3. Present clear, logical proofs with careful attention to detail
4. Include examples and counterexamples to illustrate concepts
5. Show connections between different areas of number theory
6. Discuss computational aspects when applicable
7. Provide historical context for important results and open problems
8. Highlight unsolved problems and current research directions
9. Explain the significance and applications of results
10. Encourage exploration and pattern discovery

Your responses should combine mathematical rigor with clarity, making abstract number-theoretic concepts accessible while maintaining precision. Emphasize the beauty and depth of number theory, and inspire curiosity about the mysteries of numbers.<|eot_id|><|start_header_id|>user<|end_header_id|>


停止トークン: ['<|im_start|>', '<|im_end|>', '<|endoftext|>', 'Assistant', 'assistant', '\n']
停止トークンID: [151643, 151644, 151645]
Processed prompts:   0%|▏                                   | 1/200 [00:02<09:27,  2.85s/it, est. speed input: 127.93 toks/s, output: 5785.81 toks/s]
Checkpoint saved. Total prompts: 200                        | 1/200 [00:02<09:27,  2.85s/it, est. speed input: 127.93 toks/s, output: 5785.81 toks/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:02<00:00,  2.88s/it]
HLE数学推論データ生成完了。モデル: Qwen/Qwen2.5-3B-Instruct、総問題数: 200
[rank0]:[W731 21:30:19.816278686 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
✅ ステップ1完了: 問題生成が完了しました

[ステップ 2/4] 🧠 解答生成 (高度推論)
  → Chain-of-Thought形式で詳細な解答を生成中 (最大4096トークン)...

⏳ 推定時間: 10-20分 (問題の複雑さにより変動)
Response Generation Manager. Arguments: Namespace(model_path='Qwen/Qwen2.5-3B-Instruct', input_file=None, ins_data_path='../data/Qwen2.5-3B-Instruct_statistics_20250731_212932/statistics_ins.json', save_path='../data/Qwen2.5-3B-Instruct_statistics_20250731_212932/statistics_ins_res.json', batch_size=4, checkpoint_every=20, api_url='https://api.together.xyz/v1/chat/completions', api_key=None, offline=False, engine='vllm', device='0', dtype='bfloat16', tensor_parallel_size=1, gpu_memory_utilization=0.95, max_tokens=4096, max_model_len=4096, temperature=0.0, top_p=1.0, repetition_penalty=1.0, tokenizer_template=True)
Start Local vllm engine...
INFO 07-31 21:30:42 config.py:478] This model supports multiple tasks: {'score', 'embed', 'reward', 'generate', 'classify'}. Defaulting to 'generate'.
INFO 07-31 21:30:42 llm_engine.py:249] Initializing an LLM engine (v0.6.5) with config: model='Qwen/Qwen2.5-3B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-3B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-3B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, mm_cache_preprocessor=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False,
INFO 07-31 21:30:43 selector.py:120] Using Flash Attention backend.
INFO 07-31 21:30:44 model_runner.py:1092] Starting to load model Qwen/Qwen2.5-3B-Instruct...
INFO 07-31 21:30:44 weight_utils.py:243] Using model weights format ['*.safetensors']
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.59s/it]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.22s/it]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.28s/it]

INFO 07-31 21:30:47 model_runner.py:1097] Loading model weights took 5.7915 GB
INFO 07-31 21:30:48 worker.py:241] Memory profiling takes 0.43 seconds
INFO 07-31 21:30:48 worker.py:241] the current vLLM instance can use total_gpu_memory (79.44GiB) x gpu_memory_utilization (0.95) = 75.47GiB
INFO 07-31 21:30:48 worker.py:241] model weights take 5.79GiB; non_torch_memory takes 0.25GiB; PyTorch activation peak memory takes 1.42GiB; the rest of the memory reserved for KV Cache is 68.00GiB.
INFO 07-31 21:30:48 gpu_executor.py:76] # GPU blocks: 123797, # CPU blocks: 7281
INFO 07-31 21:30:48 gpu_executor.py:80] Maximum concurrency for 4096 tokens per request: 483.58x
INFO 07-31 21:30:49 model_runner.py:1413] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 07-31 21:30:49 model_runner.py:1417] If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 07-31 21:30:58 model_runner.py:1527] Graph capturing finished in 9 secs, took 0.29 GiB
INFO 07-31 21:30:58 llm_engine.py:446] init engine (profile, create kv cache, warmup model) took 10.88 seconds
Total number of batches: 50
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:12<00:00,  3.17s/it, est. speed input: 28.96 toks/s, output: 397.80 toks/s]
Dataset checkpoint saved after batch 1.█████████████████████████| 4/4 [00:12<00:00,  3.58s/it, est. speed input: 28.96 toks/s, output: 397.80 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:05<00:00,  1.41s/it, est. speed input: 82.37 toks/s, output: 514.54 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 4/4 [00:04<00:00,  1.01s/it, est. speed input: 110.88 toks/s, output: 549.18 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:07<00:00,  1.91s/it, est. speed input: 64.63 toks/s, output: 489.30 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:03<00:00,  1.02it/s, est. speed input: 96.97 toks/s, output: 607.03 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:06<00:00,  1.56s/it, est. speed input: 99.10 toks/s, output: 433.10 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:19<00:00,  4.84s/it, est. speed input: 29.58 toks/s, output: 251.29 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:04<00:00,  1.14s/it, est. speed input: 92.40 toks/s, output: 642.87 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 4/4 [00:04<00:00,  1.03s/it, est. speed input: 104.93 toks/s, output: 538.02 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:07<00:00,  1.79s/it, est. speed input: 81.24 toks/s, output: 490.09 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:06<00:00,  1.66s/it, est. speed input: 67.95 toks/s, output: 447.53 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:19<00:00,  4.90s/it, est. speed input: 24.10 toks/s, output: 288.78 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:04<00:00,  1.22s/it, est. speed input: 99.46 toks/s, output: 521.09 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:06<00:00,  1.62s/it, est. speed input: 84.82 toks/s, output: 525.90 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:08<00:00,  2.00s/it, est. speed input: 71.61 toks/s, output: 436.27 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:20<00:00,  5.02s/it, est. speed input: 27.41 toks/s, output: 359.40 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:06<00:00,  1.55s/it, est. speed input: 64.39 toks/s, output: 504.18 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:09<00:00,  2.41s/it, est. speed input: 34.99 toks/s, output: 311.82 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:10<00:00,  2.55s/it, est. speed input: 42.62 toks/s, output: 493.13 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:04<00:00,  1.25s/it, est. speed input: 81.12 toks/s, output: 292.95 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 4/4 [00:03<00:00,  1.17it/s, est. speed input: 122.94 toks/s, output: 522.13 toks/s]
Dataset checkpoint saved after batch 21.███████████████████████| 4/4 [00:03<00:00,  1.27it/s, est. speed input: 122.94 toks/s, output: 522.13 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:04<00:00,  1.16s/it, est. speed input: 69.48 toks/s, output: 525.53 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:04<00:00,  1.16s/it, est. speed input: 90.16 toks/s, output: 572.69 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:19<00:00,  4.86s/it, est. speed input: 24.43 toks/s, output: 304.80 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:04<00:00,  1.18s/it, est. speed input: 78.98 toks/s, output: 527.15 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:05<00:00,  1.30s/it, est. speed input: 81.82 toks/s, output: 659.75 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:19<00:00,  4.81s/it, est. speed input: 20.93 toks/s, output: 298.20 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 4/4 [00:03<00:00,  1.14it/s, est. speed input: 133.90 toks/s, output: 674.61 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:05<00:00,  1.42s/it, est. speed input: 98.32 toks/s, output: 631.68 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:04<00:00,  1.13s/it, est. speed input: 91.88 toks/s, output: 688.09 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:05<00:00,  1.32s/it, est. speed input: 75.17 toks/s, output: 423.39 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:06<00:00,  1.69s/it, est. speed input: 61.22 toks/s, output: 511.46 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:05<00:00,  1.31s/it, est. speed input: 73.82 toks/s, output: 614.05 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:19<00:00,  4.82s/it, est. speed input: 35.54 toks/s, output: 306.30 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:05<00:00,  1.37s/it, est. speed input: 71.18 toks/s, output: 610.87 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:06<00:00,  1.67s/it, est. speed input: 51.76 toks/s, output: 504.88 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:08<00:00,  2.18s/it, est. speed input: 73.03 toks/s, output: 498.60 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:06<00:00,  1.69s/it, est. speed input: 48.05 toks/s, output: 498.87 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 4/4 [00:03<00:00,  1.33it/s, est. speed input: 138.31 toks/s, output: 506.71 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:19<00:00,  4.84s/it, est. speed input: 28.73 toks/s, output: 343.93 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:07<00:00,  1.93s/it, est. speed input: 61.63 toks/s, output: 593.71 toks/s]
Dataset checkpoint saved after batch 41.████████████████████████| 4/4 [00:07<00:00,  1.56s/it, est. speed input: 61.63 toks/s, output: 593.71 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:06<00:00,  1.51s/it, est. speed input: 62.37 toks/s, output: 488.21 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:19<00:00,  4.91s/it, est. speed input: 24.60 toks/s, output: 332.85 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 4/4 [00:03<00:00,  1.32it/s, est. speed input: 154.89 toks/s, output: 567.59 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:08<00:00,  2.07s/it, est. speed input: 53.93 toks/s, output: 413.93 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 4/4 [00:02<00:00,  1.61it/s, est. speed input: 163.72 toks/s, output: 539.02 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:04<00:00,  1.06s/it, est. speed input: 75.23 toks/s, output: 540.32 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:19<00:00,  4.97s/it, est. speed input: 17.46 toks/s, output: 378.50 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:19<00:00,  4.88s/it, est. speed input: 20.78 toks/s, output: 285.29 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 4/4 [00:11<00:00,  2.79s/it, est. speed input: 25.93 toks/s, output: 380.79 toks/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [07:15<00:00,  8.71s/it]
Final dataset saved. Checkpoint removed.
[rank0]:[W731 21:38:16.874266541 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
✅ ステップ2完了: 解答生成が完了しました

[ステップ 3/4] 🔄 多様な解答生成
  → 各問題に対し7種類の異なる解答を生成中 (学習用データ)...

⏳ 推定時間: 15-30分 (特に時間がかかるステップ)
Response Generation Manager. Arguments: Namespace(model_path='Qwen/Qwen2.5-3B-Instruct', input_file=None, ins_data_path='../data/Qwen2.5-3B-Instruct_statistics_20250731_212932/statistics_ins.json', save_path='../data/Qwen2.5-3B-Instruct_statistics_20250731_212932/statistics_ins_7res.json', batch_size=2, checkpoint_every=20, api_url='https://api.together.xyz/v1/chat/completions', api_key=None, offline=False, engine='vllm', device='0', dtype='bfloat16', tensor_parallel_size=1, gpu_memory_utilization=0.95, max_tokens=4096, max_model_len=4096, temperature=0.8, top_p=0.95, repetition_penalty=1.0, num_samples=5, num_responses=7, tokenizer_template=False)
Start Local vllm engine...
INFO 07-31 21:38:40 config.py:478] This model supports multiple tasks: {'classify', 'generate', 'reward', 'score', 'embed'}. Defaulting to 'generate'.
INFO 07-31 21:38:40 llm_engine.py:249] Initializing an LLM engine (v0.6.5) with config: model='Qwen/Qwen2.5-3B-Instruct', speculative_config=None, tokenizer='Qwen/Qwen2.5-3B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=Qwen/Qwen2.5-3B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=False, use_async_output_proc=True, mm_cache_preprocessor=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"candidate_compile_sizes":[],"compile_sizes":[],"capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=False,
INFO 07-31 21:38:41 selector.py:120] Using Flash Attention backend.
INFO 07-31 21:38:42 model_runner.py:1092] Starting to load model Qwen/Qwen2.5-3B-Instruct...
INFO 07-31 21:38:42 weight_utils.py:243] Using model weights format ['*.safetensors']
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.60s/it]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.23s/it]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.28s/it]

INFO 07-31 21:38:46 model_runner.py:1097] Loading model weights took 5.7915 GB
INFO 07-31 21:38:46 worker.py:241] Memory profiling takes 0.42 seconds
INFO 07-31 21:38:46 worker.py:241] the current vLLM instance can use total_gpu_memory (79.44GiB) x gpu_memory_utilization (0.95) = 75.47GiB
INFO 07-31 21:38:46 worker.py:241] model weights take 5.79GiB; non_torch_memory takes 0.25GiB; PyTorch activation peak memory takes 1.42GiB; the rest of the memory reserved for KV Cache is 68.00GiB.
INFO 07-31 21:38:46 gpu_executor.py:76] # GPU blocks: 123797, # CPU blocks: 7281
INFO 07-31 21:38:46 gpu_executor.py:80] Maximum concurrency for 4096 tokens per request: 483.58x
INFO 07-31 21:38:48 model_runner.py:1413] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 07-31 21:38:48 model_runner.py:1417] If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 07-31 21:38:56 model_runner.py:1527] Graph capturing finished in 8 secs, took 0.29 GiB
INFO 07-31 21:38:56 llm_engine.py:446] init engine (profile, create kv cache, warmup model) took 10.27 seconds
Total number of batches: 100
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.30s/it, est. speed input: 20.43 toks/s, output: 246.41 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.69s/it, est. speed input: 12.75 toks/s, output: 298.65 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.71s/it, est. speed input: 17.37 toks/s, output: 326.38 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.29s/it, est. speed input: 20.52 toks/s, output: 327.02 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.26s/it, est. speed input: 14.40 toks/s, output: 305.44 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.92s/it, est. speed input: 16.11 toks/s, output: 351.00 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.38s/it, est. speed input: 19.79 toks/s, output: 313.02 toks/s]
Dataset checkpoint saved after batch 1.█████████████████████████| 2/2 [00:04<00:00,  2.16s/it, est. speed input: 19.79 toks/s, output: 313.02 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:12<00:00,  6.41s/it, est. speed input: 18.16 toks/s, output: 211.04 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:12<00:00,  6.09s/it, est. speed input: 19.14 toks/s, output: 207.23 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:20<00:00, 10.07s/it, est. speed input: 11.57 toks/s, output: 210.23 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:16<00:00,  8.16s/it, est. speed input: 14.28 toks/s, output: 215.37 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.37s/it, est. speed input: 26.68 toks/s, output: 233.11 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:12<00:00,  6.28s/it, est. speed input: 18.55 toks/s, output: 212.24 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:19<00:00,  9.52s/it, est. speed input: 12.23 toks/s, output: 211.42 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.04s/it, est. speed input: 58.64 toks/s, output: 333.22 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.77s/it, est. speed input: 67.38 toks/s, output: 343.67 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.82s/it, est. speed input: 65.68 toks/s, output: 358.63 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.89s/it, est. speed input: 30.69 toks/s, output: 268.27 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.99s/it, est. speed input: 60.02 toks/s, output: 349.32 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.92s/it, est. speed input: 62.19 toks/s, output: 338.80 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.68s/it, est. speed input: 71.23 toks/s, output: 337.09 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.01s/it, est. speed input: 31.07 toks/s, output: 339.81 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.43s/it, est. speed input: 38.53 toks/s, output: 252.63 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.65s/it, est. speed input: 35.31 toks/s, output: 332.34 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.89s/it, est. speed input: 32.35 toks/s, output: 323.30 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.42s/it, est. speed input: 27.32 toks/s, output: 268.21 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.45s/it, est. speed input: 38.11 toks/s, output: 259.05 toks/s]
Processed prompts: 100%|█████████████████████████████████████████| 2/2 [00:20<00:00, 10.17s/it, est. speed input: 9.19 toks/s, output: 249.09 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.81s/it, est. speed input: 71.93 toks/s, output: 347.20 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.13s/it, est. speed input: 61.11 toks/s, output: 334.94 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.05s/it, est. speed input: 63.30 toks/s, output: 347.67 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.99s/it, est. speed input: 65.41 toks/s, output: 356.00 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.93s/it, est. speed input: 67.49 toks/s, output: 350.45 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.37s/it, est. speed input: 54.87 toks/s, output: 358.76 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.01s/it, est. speed input: 64.62 toks/s, output: 355.91 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.67s/it, est. speed input: 27.35 toks/s, output: 205.30 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.82s/it, est. speed input: 40.01 toks/s, output: 204.17 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.17s/it, est. speed input: 33.69 toks/s, output: 209.07 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.52s/it, est. speed input: 28.92 toks/s, output: 207.18 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.43s/it, est. speed input: 21.26 toks/s, output: 205.50 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.96s/it, est. speed input: 37.22 toks/s, output: 203.94 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.31s/it, est. speed input: 31.58 toks/s, output: 207.90 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.08s/it, est. speed input: 49.99 toks/s, output: 255.80 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.91s/it, est. speed input: 52.87 toks/s, output: 272.61 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:19<00:00,  9.79s/it, est. speed input: 15.73 toks/s, output: 217.74 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.49s/it, est. speed input: 44.07 toks/s, output: 302.50 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.03s/it, est. speed input: 75.86 toks/s, output: 311.08 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.62s/it, est. speed input: 95.16 toks/s, output: 302.47 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.91s/it, est. speed input: 80.58 toks/s, output: 297.98 toks/s]
Processed prompts: 100%|█████████████████████████████████████████| 2/2 [00:20<00:00, 10.06s/it, est. speed input: 7.26 toks/s, output: 218.12 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.39s/it, est. speed input: 30.53 toks/s, output: 317.84 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.19s/it, est. speed input: 33.27 toks/s, output: 270.91 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:09<00:00,  4.84s/it, est. speed input: 15.09 toks/s, output: 249.42 toks/s]
Processed prompts: 100%|█████████████████████████████████████████| 2/2 [00:20<00:00, 10.06s/it, est. speed input: 7.26 toks/s, output: 217.18 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.59s/it, est. speed input: 46.02 toks/s, output: 355.55 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.51s/it, est. speed input: 29.11 toks/s, output: 294.49 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.18s/it, est. speed input: 59.60 toks/s, output: 286.78 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.91s/it, est. speed input: 68.19 toks/s, output: 362.46 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.98s/it, est. speed input: 65.65 toks/s, output: 339.63 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.93s/it, est. speed input: 67.50 toks/s, output: 331.55 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.09s/it, est. speed input: 62.29 toks/s, output: 355.76 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.35s/it, est. speed input: 55.42 toks/s, output: 339.58 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  2.00s/it, est. speed input: 65.12 toks/s, output: 316.32 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.61s/it, est. speed input: 25.11 toks/s, output: 293.62 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.79s/it, est. speed input: 22.56 toks/s, output: 284.98 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.13s/it, est. speed input: 35.96 toks/s, output: 335.23 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.02s/it, est. speed input: 20.10 toks/s, output: 260.00 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.98s/it, est. speed input: 20.49 toks/s, output: 268.38 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.36s/it, est. speed input: 29.82 toks/s, output: 313.66 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.95s/it, est. speed input: 20.82 toks/s, output: 285.87 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:09<00:00,  4.81s/it, est. speed input: 21.82 toks/s, output: 285.68 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.89s/it, est. speed input: 36.33 toks/s, output: 345.99 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.00s/it, est. speed input: 34.99 toks/s, output: 355.93 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.82s/it, est. speed input: 37.27 toks/s, output: 347.53 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.22s/it, est. speed input: 47.24 toks/s, output: 333.14 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.98s/it, est. speed input: 53.01 toks/s, output: 321.37 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.58s/it, est. speed input: 40.77 toks/s, output: 358.61 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 2/2 [00:02<00:00,  1.08s/it, est. speed input: 170.36 toks/s, output: 274.98 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 2/2 [00:02<00:00,  1.24s/it, est. speed input: 148.64 toks/s, output: 279.10 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 2/2 [00:02<00:00,  1.16s/it, est. speed input: 158.55 toks/s, output: 338.22 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.91s/it, est. speed input: 96.24 toks/s, output: 264.92 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 2/2 [00:03<00:00,  1.51s/it, est. speed input: 121.98 toks/s, output: 317.55 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 2/2 [00:02<00:00,  1.25s/it, est. speed input: 147.16 toks/s, output: 274.72 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 2/2 [00:02<00:00,  1.43s/it, est. speed input: 128.92 toks/s, output: 297.43 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.97s/it, est. speed input: 59.35 toks/s, output: 257.95 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.33s/it, est. speed input: 75.50 toks/s, output: 227.15 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.18s/it, est. speed input: 80.61 toks/s, output: 259.01 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.15s/it, est. speed input: 81.71 toks/s, output: 246.30 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.70s/it, est. speed input: 65.22 toks/s, output: 294.80 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.59s/it, est. speed input: 68.07 toks/s, output: 257.59 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.43s/it, est. speed input: 72.52 toks/s, output: 247.22 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.45s/it, est. speed input: 37.00 toks/s, output: 204.03 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.50s/it, est. speed input: 60.49 toks/s, output: 206.87 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.06s/it, est. speed input: 43.87 toks/s, output: 206.97 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.79s/it, est. speed input: 50.62 toks/s, output: 211.70 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.16s/it, est. speed input: 28.64 toks/s, output: 205.25 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.30s/it, est. speed input: 69.59 toks/s, output: 213.01 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.80s/it, est. speed input: 50.26 toks/s, output: 206.58 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.06s/it, est. speed input: 42.32 toks/s, output: 340.72 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.75s/it, est. speed input: 47.15 toks/s, output: 323.87 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.36s/it, est. speed input: 38.52 toks/s, output: 337.46 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.67s/it, est. speed input: 48.57 toks/s, output: 348.26 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.79s/it, est. speed input: 46.44 toks/s, output: 344.29 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.54s/it, est. speed input: 51.00 toks/s, output: 316.41 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.71s/it, est. speed input: 34.92 toks/s, output: 288.82 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.24s/it, est. speed input: 27.02 toks/s, output: 320.72 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.41s/it, est. speed input: 25.14 toks/s, output: 313.36 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.32s/it, est. speed input: 26.10 toks/s, output: 285.21 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.61s/it, est. speed input: 37.49 toks/s, output: 305.47 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.19s/it, est. speed input: 27.67 toks/s, output: 335.92 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.98s/it, est. speed input: 30.57 toks/s, output: 306.50 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.28s/it, est. speed input: 26.54 toks/s, output: 315.61 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.18s/it, est. speed input: 37.07 toks/s, output: 320.60 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.54s/it, est. speed input: 46.49 toks/s, output: 287.61 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.31s/it, est. speed input: 51.00 toks/s, output: 278.76 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.38s/it, est. speed input: 49.50 toks/s, output: 314.84 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.27s/it, est. speed input: 36.03 toks/s, output: 264.44 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.68s/it, est. speed input: 44.03 toks/s, output: 320.72 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.02s/it, est. speed input: 58.37 toks/s, output: 353.19 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.10s/it, est. speed input: 37.09 toks/s, output: 259.39 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.22s/it, est. speed input: 35.11 toks/s, output: 248.00 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.57s/it, est. speed input: 30.30 toks/s, output: 233.83 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.96s/it, est. speed input: 39.86 toks/s, output: 296.15 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.94s/it, est. speed input: 40.11 toks/s, output: 262.76 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.28s/it, est. speed input: 34.22 toks/s, output: 245.00 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.11s/it, est. speed input: 36.89 toks/s, output: 275.25 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:10<00:00,  5.45s/it, est. speed input: 30.01 toks/s, output: 276.31 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:09<00:00,  4.90s/it, est. speed input: 33.35 toks/s, output: 341.69 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.33s/it, est. speed input: 37.72 toks/s, output: 297.49 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.24s/it, est. speed input: 38.58 toks/s, output: 318.47 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.77s/it, est. speed input: 43.31 toks/s, output: 355.39 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:10<00:00,  5.44s/it, est. speed input: 30.07 toks/s, output: 295.65 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.30s/it, est. speed input: 49.51 toks/s, output: 324.43 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.12s/it, est. speed input: 96.58 toks/s, output: 290.18 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.97s/it, est. speed input: 54.72 toks/s, output: 272.09 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.09s/it, est. speed input: 51.62 toks/s, output: 254.04 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 2/2 [00:01<00:00,  1.43it/s, est. speed input: 154.55 toks/s, output: 340.57 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.81s/it, est. speed input: 59.77 toks/s, output: 260.93 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.13s/it, est. speed input: 34.51 toks/s, output: 258.84 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.08s/it, est. speed input: 51.88 toks/s, output: 269.25 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.84s/it, est. speed input: 46.35 toks/s, output: 328.48 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.15s/it, est. speed input: 41.76 toks/s, output: 261.52 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.63s/it, est. speed input: 36.27 toks/s, output: 330.38 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.34s/it, est. speed input: 56.21 toks/s, output: 341.74 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.31s/it, est. speed input: 56.95 toks/s, output: 331.94 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.47s/it, est. speed input: 29.44 toks/s, output: 301.88 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.32s/it, est. speed input: 30.41 toks/s, output: 328.85 toks/s]
Dataset checkpoint saved after batch 21.████████████████████████| 2/2 [00:08<00:00,  3.90s/it, est. speed input: 30.41 toks/s, output: 328.85 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.36s/it, est. speed input: 54.05 toks/s, output: 328.34 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.65s/it, est. speed input: 44.54 toks/s, output: 360.55 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.27s/it, est. speed input: 57.96 toks/s, output: 320.55 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.51s/it, est. speed input: 48.53 toks/s, output: 337.38 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.61s/it, est. speed input: 45.75 toks/s, output: 293.48 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.38s/it, est. speed input: 53.30 toks/s, output: 342.29 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.38s/it, est. speed input: 53.14 toks/s, output: 346.68 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:19<00:00,  9.88s/it, est. speed input: 12.96 toks/s, output: 226.22 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.18s/it, est. speed input: 58.73 toks/s, output: 313.83 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:09<00:00,  4.75s/it, est. speed input: 26.96 toks/s, output: 262.33 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:19<00:00,  9.87s/it, est. speed input: 12.97 toks/s, output: 224.37 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.63s/it, est. speed input: 48.70 toks/s, output: 297.51 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.52s/it, est. speed input: 84.23 toks/s, output: 337.90 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:19<00:00,  9.86s/it, est. speed input: 12.98 toks/s, output: 220.03 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.69s/it, est. speed input: 32.68 toks/s, output: 255.33 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.13s/it, est. speed input: 77.76 toks/s, output: 342.42 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.71s/it, est. speed input: 51.58 toks/s, output: 286.04 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.29s/it, est. speed input: 38.36 toks/s, output: 320.21 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.34s/it, est. speed input: 65.71 toks/s, output: 306.14 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.45s/it, est. speed input: 60.62 toks/s, output: 295.51 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.73s/it, est. speed input: 50.95 toks/s, output: 285.13 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.49s/it, est. speed input: 37.16 toks/s, output: 260.49 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.27s/it, est. speed input: 40.72 toks/s, output: 268.34 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.84s/it, est. speed input: 32.63 toks/s, output: 251.33 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.67s/it, est. speed input: 34.63 toks/s, output: 254.37 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.27s/it, est. speed input: 40.76 toks/s, output: 268.82 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.70s/it, est. speed input: 34.31 toks/s, output: 250.74 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.17s/it, est. speed input: 42.54 toks/s, output: 273.84 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.21s/it, est. speed input: 58.75 toks/s, output: 272.51 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.75s/it, est. speed input: 74.11 toks/s, output: 272.76 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.17s/it, est. speed input: 59.91 toks/s, output: 283.66 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.28s/it, est. speed input: 56.99 toks/s, output: 299.18 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.51s/it, est. speed input: 51.82 toks/s, output: 274.24 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.42s/it, est. speed input: 53.68 toks/s, output: 260.34 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.79s/it, est. speed input: 72.67 toks/s, output: 314.70 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.40s/it, est. speed input: 74.68 toks/s, output: 298.92 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.27s/it, est. speed input: 41.88 toks/s, output: 227.88 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.80s/it, est. speed input: 63.96 toks/s, output: 308.38 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.29s/it, est. speed input: 54.42 toks/s, output: 302.03 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.46s/it, est. speed input: 51.70 toks/s, output: 312.67 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.47s/it, est. speed input: 51.54 toks/s, output: 285.92 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.08s/it, est. speed input: 58.18 toks/s, output: 293.01 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.67s/it, est. speed input: 45.20 toks/s, output: 319.13 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.72s/it, est. speed input: 44.00 toks/s, output: 333.32 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.78s/it, est. speed input: 42.45 toks/s, output: 338.48 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  2.00s/it, est. speed input: 37.84 toks/s, output: 352.58 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.54s/it, est. speed input: 49.03 toks/s, output: 327.94 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.85s/it, est. speed input: 40.71 toks/s, output: 361.23 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.61s/it, est. speed input: 46.77 toks/s, output: 361.14 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.84s/it, est. speed input: 40.38 toks/s, output: 238.58 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.82s/it, est. speed input: 62.94 toks/s, output: 306.17 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.69s/it, est. speed input: 42.60 toks/s, output: 236.64 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.43s/it, est. speed input: 80.12 toks/s, output: 264.15 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.19s/it, est. speed input: 96.05 toks/s, output: 283.12 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.91s/it, est. speed input: 60.07 toks/s, output: 249.46 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.04s/it, est. speed input: 56.25 toks/s, output: 259.63 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.87s/it, est. speed input: 53.05 toks/s, output: 364.02 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.23s/it, est. speed input: 47.17 toks/s, output: 349.70 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.93s/it, est. speed input: 38.77 toks/s, output: 330.87 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.38s/it, est. speed input: 64.02 toks/s, output: 340.23 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.15s/it, est. speed input: 48.37 toks/s, output: 357.63 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.24s/it, est. speed input: 47.04 toks/s, output: 317.24 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.18s/it, est. speed input: 47.95 toks/s, output: 324.02 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.57s/it, est. speed input: 50.09 toks/s, output: 275.41 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.37s/it, est. speed input: 54.18 toks/s, output: 351.62 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.97s/it, est. speed input: 43.25 toks/s, output: 315.00 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.04s/it, est. speed input: 42.27 toks/s, output: 282.10 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.98s/it, est. speed input: 43.07 toks/s, output: 303.85 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.17s/it, est. speed input: 40.48 toks/s, output: 292.97 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.44s/it, est. speed input: 52.62 toks/s, output: 305.91 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.80s/it, est. speed input: 45.16 toks/s, output: 343.24 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.50s/it, est. speed input: 50.61 toks/s, output: 314.28 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.03s/it, est. speed input: 41.69 toks/s, output: 299.44 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.16s/it, est. speed input: 40.01 toks/s, output: 286.24 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.52s/it, est. speed input: 35.98 toks/s, output: 332.96 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.72s/it, est. speed input: 46.49 toks/s, output: 306.16 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.07s/it, est. speed input: 41.23 toks/s, output: 322.47 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.37s/it, est. speed input: 43.52 toks/s, output: 251.64 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.44s/it, est. speed input: 71.78 toks/s, output: 334.50 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.31s/it, est. speed input: 44.51 toks/s, output: 343.76 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.49s/it, est. speed input: 41.35 toks/s, output: 348.87 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.79s/it, est. speed input: 57.48 toks/s, output: 277.65 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.97s/it, est. speed input: 52.27 toks/s, output: 350.38 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.73s/it, est. speed input: 59.68 toks/s, output: 305.65 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.60s/it, est. speed input: 21.25 toks/s, output: 328.81 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.57s/it, est. speed input: 29.82 toks/s, output: 207.37 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.41s/it, est. speed input: 22.43 toks/s, output: 331.04 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.12s/it, est. speed input: 24.54 toks/s, output: 205.43 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.66s/it, est. speed input: 20.93 toks/s, output: 203.66 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.87s/it, est. speed input: 19.77 toks/s, output: 334.34 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.23s/it, est. speed input: 18.07 toks/s, output: 292.97 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.03s/it, est. speed input: 67.76 toks/s, output: 226.01 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.04s/it, est. speed input: 67.56 toks/s, output: 224.39 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.40s/it, est. speed input: 49.97 toks/s, output: 203.46 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.29s/it, est. speed input: 54.07 toks/s, output: 218.59 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.49s/it, est. speed input: 47.14 toks/s, output: 203.36 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.01s/it, est. speed input: 34.74 toks/s, output: 213.42 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.85s/it, est. speed input: 37.79 toks/s, output: 213.77 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.35s/it, est. speed input: 17.81 toks/s, output: 267.10 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.38s/it, est. speed input: 17.71 toks/s, output: 221.45 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:09<00:00,  4.81s/it, est. speed input: 16.11 toks/s, output: 253.63 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.58s/it, est. speed input: 21.68 toks/s, output: 316.89 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.81s/it, est. speed input: 27.55 toks/s, output: 236.58 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.48s/it, est. speed input: 22.26 toks/s, output: 227.45 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.08s/it, est. speed input: 19.01 toks/s, output: 223.99 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.90s/it, est. speed input: 27.04 toks/s, output: 288.27 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.93s/it, est. speed input: 36.00 toks/s, output: 359.12 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.64s/it, est. speed input: 39.91 toks/s, output: 354.81 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.82s/it, est. speed input: 37.40 toks/s, output: 346.01 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.15s/it, est. speed input: 33.48 toks/s, output: 349.74 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.73s/it, est. speed input: 38.68 toks/s, output: 330.54 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.90s/it, est. speed input: 36.35 toks/s, output: 324.71 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.59s/it, est. speed input: 25.51 toks/s, output: 322.14 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.67s/it, est. speed input: 24.96 toks/s, output: 325.47 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.08s/it, est. speed input: 29.72 toks/s, output: 356.66 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.28s/it, est. speed input: 27.88 toks/s, output: 308.24 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.34s/it, est. speed input: 27.38 toks/s, output: 351.89 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.11s/it, est. speed input: 22.26 toks/s, output: 326.97 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:09<00:00,  4.85s/it, est. speed input: 18.85 toks/s, output: 297.36 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 2/2 [00:02<00:00,  1.03s/it, est. speed input: 110.63 toks/s, output: 220.78 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.60s/it, est. speed input: 43.59 toks/s, output: 211.61 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 2/2 [00:01<00:00,  1.18it/s, est. speed input: 134.15 toks/s, output: 235.80 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.06s/it, est. speed input: 55.18 toks/s, output: 209.04 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 2/2 [00:01<00:00,  1.05it/s, est. speed input: 119.49 toks/s, output: 216.35 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.41s/it, est. speed input: 80.53 toks/s, output: 210.38 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.15s/it, est. speed input: 98.50 toks/s, output: 227.37 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.02s/it, est. speed input: 33.86 toks/s, output: 257.55 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.57s/it, est. speed input: 26.65 toks/s, output: 275.44 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.44s/it, est. speed input: 47.51 toks/s, output: 326.67 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.08s/it, est. speed input: 63.72 toks/s, output: 329.78 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.03s/it, est. speed input: 66.81 toks/s, output: 212.62 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.26s/it, est. speed input: 30.32 toks/s, output: 333.48 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.97s/it, est. speed input: 34.74 toks/s, output: 207.41 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.35s/it, est. speed input: 66.39 toks/s, output: 305.24 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.42s/it, est. speed input: 62.86 toks/s, output: 339.58 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.31s/it, est. speed input: 38.67 toks/s, output: 276.29 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.80s/it, est. speed input: 49.71 toks/s, output: 316.56 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.59s/it, est. speed input: 56.27 toks/s, output: 280.41 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.11s/it, est. speed input: 80.31 toks/s, output: 348.62 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.40s/it, est. speed input: 63.72 toks/s, output: 297.94 toks/s]
Dataset checkpoint saved after batch 41.████████████████████████| 2/2 [00:02<00:00,  1.36s/it, est. speed input: 63.72 toks/s, output: 297.94 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.01s/it, est. speed input: 25.21 toks/s, output: 219.30 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 2/2 [00:01<00:00,  1.21it/s, est. speed input: 122.24 toks/s, output: 320.73 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.27s/it, est. speed input: 44.42 toks/s, output: 246.72 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.69s/it, est. speed input: 27.36 toks/s, output: 225.90 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.41s/it, est. speed input: 71.73 toks/s, output: 320.63 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.47s/it, est. speed input: 40.91 toks/s, output: 238.18 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.09s/it, est. speed input: 24.69 toks/s, output: 221.60 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.16s/it, est. speed input: 20.59 toks/s, output: 286.40 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.47s/it, est. speed input: 26.35 toks/s, output: 273.28 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.17s/it, est. speed input: 29.96 toks/s, output: 265.99 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.48s/it, est. speed input: 26.18 toks/s, output: 293.17 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:09<00:00,  4.97s/it, est. speed input: 13.08 toks/s, output: 231.51 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.81s/it, est. speed input: 35.93 toks/s, output: 331.95 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.58s/it, est. speed input: 25.22 toks/s, output: 304.62 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.25s/it, est. speed input: 33.59 toks/s, output: 274.97 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.02s/it, est. speed input: 37.29 toks/s, output: 246.44 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.32s/it, est. speed input: 32.56 toks/s, output: 264.33 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.25s/it, est. speed input: 33.48 toks/s, output: 244.59 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.78s/it, est. speed input: 42.44 toks/s, output: 252.70 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.74s/it, est. speed input: 43.42 toks/s, output: 245.58 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.98s/it, est. speed input: 38.11 toks/s, output: 281.93 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.42s/it, est. speed input: 86.22 toks/s, output: 360.71 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.85s/it, est. speed input: 66.08 toks/s, output: 285.07 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.42s/it, est. speed input: 86.02 toks/s, output: 349.33 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.40s/it, est. speed input: 87.67 toks/s, output: 355.71 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 2/2 [00:02<00:00,  1.23s/it, est. speed input: 100.01 toks/s, output: 311.04 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.31s/it, est. speed input: 93.18 toks/s, output: 361.71 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.77s/it, est. speed input: 69.25 toks/s, output: 324.19 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.39s/it, est. speed input: 27.87 toks/s, output: 353.45 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.27s/it, est. speed input: 29.29 toks/s, output: 346.18 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.08s/it, est. speed input: 16.31 toks/s, output: 282.24 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.20s/it, est. speed input: 30.25 toks/s, output: 320.96 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.23s/it, est. speed input: 29.87 toks/s, output: 360.69 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.69s/it, est. speed input: 24.71 toks/s, output: 296.14 toks/s]
Processed prompts: 100%|█████████████████████████████████████████| 2/2 [00:20<00:00, 10.26s/it, est. speed input: 6.48 toks/s, output: 233.10 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.06s/it, est. speed input: 31.52 toks/s, output: 292.15 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.37s/it, est. speed input: 40.65 toks/s, output: 307.07 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.19s/it, est. speed input: 44.13 toks/s, output: 351.20 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.31s/it, est. speed input: 41.72 toks/s, output: 328.38 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.13s/it, est. speed input: 45.41 toks/s, output: 336.23 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.92s/it, est. speed input: 50.32 toks/s, output: 291.99 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.99s/it, est. speed input: 48.38 toks/s, output: 353.19 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.23s/it, est. speed input: 54.19 toks/s, output: 273.41 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.88s/it, est. speed input: 64.35 toks/s, output: 290.38 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.52s/it, est. speed input: 47.93 toks/s, output: 286.20 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.59s/it, est. speed input: 76.33 toks/s, output: 308.49 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.27s/it, est. speed input: 53.36 toks/s, output: 276.71 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.83s/it, est. speed input: 66.18 toks/s, output: 310.40 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.70s/it, est. speed input: 44.78 toks/s, output: 273.65 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.34s/it, est. speed input: 81.85 toks/s, output: 267.49 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.24s/it, est. speed input: 89.06 toks/s, output: 300.77 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.47s/it, est. speed input: 75.05 toks/s, output: 284.15 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.78s/it, est. speed input: 61.83 toks/s, output: 256.89 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.63s/it, est. speed input: 67.45 toks/s, output: 285.42 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.19s/it, est. speed input: 92.56 toks/s, output: 313.46 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.13s/it, est. speed input: 97.51 toks/s, output: 302.28 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.75s/it, est. speed input: 31.91 toks/s, output: 301.47 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.96s/it, est. speed input: 28.63 toks/s, output: 348.92 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.50s/it, est. speed input: 22.41 toks/s, output: 320.16 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.45s/it, est. speed input: 22.85 toks/s, output: 305.25 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.38s/it, est. speed input: 40.64 toks/s, output: 359.26 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.93s/it, est. speed input: 29.09 toks/s, output: 311.91 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.13s/it, est. speed input: 26.28 toks/s, output: 302.17 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:11<00:00,  5.55s/it, est. speed input: 20.89 toks/s, output: 344.17 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.22s/it, est. speed input: 35.97 toks/s, output: 323.14 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.01s/it, est. speed input: 38.58 toks/s, output: 334.08 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.03s/it, est. speed input: 38.35 toks/s, output: 363.46 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.78s/it, est. speed input: 41.67 toks/s, output: 268.13 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:10<00:00,  5.07s/it, est. speed input: 22.88 toks/s, output: 267.02 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.42s/it, est. speed input: 47.96 toks/s, output: 358.69 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.36s/it, est. speed input: 32.15 toks/s, output: 289.10 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.16s/it, est. speed input: 35.26 toks/s, output: 337.72 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.31s/it, est. speed input: 32.92 toks/s, output: 333.53 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.48s/it, est. speed input: 30.69 toks/s, output: 301.07 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.82s/it, est. speed input: 41.65 toks/s, output: 345.22 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.67s/it, est. speed input: 28.44 toks/s, output: 342.36 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.66s/it, est. speed input: 28.60 toks/s, output: 336.93 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.06s/it, est. speed input: 31.05 toks/s, output: 352.71 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.03s/it, est. speed input: 31.38 toks/s, output: 296.44 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.30s/it, est. speed input: 28.79 toks/s, output: 257.61 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.78s/it, est. speed input: 25.12 toks/s, output: 235.91 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.00s/it, est. speed input: 23.74 toks/s, output: 243.80 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.57s/it, est. speed input: 26.63 toks/s, output: 230.52 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.30s/it, est. speed input: 41.29 toks/s, output: 361.42 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.55s/it, est. speed input: 33.90 toks/s, output: 203.96 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.73s/it, est. speed input: 50.07 toks/s, output: 205.80 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.82s/it, est. speed input: 30.63 toks/s, output: 204.35 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.93s/it, est. speed input: 44.82 toks/s, output: 205.20 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.36s/it, est. speed input: 36.67 toks/s, output: 206.05 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.01s/it, est. speed input: 21.55 toks/s, output: 203.29 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.99s/it, est. speed input: 43.50 toks/s, output: 204.67 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.29s/it, est. speed input: 26.86 toks/s, output: 322.15 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.92s/it, est. speed input: 32.05 toks/s, output: 323.60 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.96s/it, est. speed input: 31.42 toks/s, output: 310.84 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.82s/it, est. speed input: 33.72 toks/s, output: 364.02 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.11s/it, est. speed input: 29.11 toks/s, output: 320.19 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.99s/it, est. speed input: 30.88 toks/s, output: 327.93 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.69s/it, est. speed input: 36.29 toks/s, output: 342.25 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.18s/it, est. speed input: 70.38 toks/s, output: 276.03 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.87s/it, est. speed input: 81.87 toks/s, output: 309.36 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.89s/it, est. speed input: 81.29 toks/s, output: 298.13 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.97s/it, est. speed input: 77.82 toks/s, output: 263.12 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.41s/it, est. speed input: 63.59 toks/s, output: 269.49 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.91s/it, est. speed input: 80.50 toks/s, output: 314.14 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.22s/it, est. speed input: 69.17 toks/s, output: 292.69 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.43s/it, est. speed input: 34.94 toks/s, output: 327.13 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.84s/it, est. speed input: 42.26 toks/s, output: 354.31 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.87s/it, est. speed input: 41.80 toks/s, output: 321.68 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.51s/it, est. speed input: 47.74 toks/s, output: 317.05 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.56s/it, est. speed input: 33.70 toks/s, output: 356.80 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.32s/it, est. speed input: 51.66 toks/s, output: 313.60 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.50s/it, est. speed input: 47.94 toks/s, output: 316.79 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.12s/it, est. speed input: 66.14 toks/s, output: 350.77 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.92s/it, est. speed input: 47.99 toks/s, output: 306.98 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.54s/it, est. speed input: 55.14 toks/s, output: 358.98 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:09<00:00,  4.99s/it, est. speed input: 28.07 toks/s, output: 275.13 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.16s/it, est. speed input: 64.93 toks/s, output: 291.72 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.91s/it, est. speed input: 73.37 toks/s, output: 294.01 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.95s/it, est. speed input: 71.75 toks/s, output: 281.89 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.19s/it, est. speed input: 30.86 toks/s, output: 311.98 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.31s/it, est. speed input: 29.28 toks/s, output: 361.71 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:09<00:00,  4.98s/it, est. speed input: 13.57 toks/s, output: 240.58 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.28s/it, est. speed input: 29.64 toks/s, output: 286.26 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.08s/it, est. speed input: 21.95 toks/s, output: 320.15 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.02s/it, est. speed input: 33.45 toks/s, output: 309.93 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.37s/it, est. speed input: 28.51 toks/s, output: 341.91 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:12<00:00,  6.31s/it, est. speed input: 19.18 toks/s, output: 225.11 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.18s/it, est. speed input: 55.43 toks/s, output: 363.97 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.10s/it, est. speed input: 39.07 toks/s, output: 266.52 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.57s/it, est. speed input: 47.03 toks/s, output: 344.33 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.76s/it, est. speed input: 43.89 toks/s, output: 279.30 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.34s/it, est. speed input: 51.69 toks/s, output: 266.12 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.69s/it, est. speed input: 71.53 toks/s, output: 339.05 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.53s/it, est. speed input: 33.04 toks/s, output: 246.66 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.12s/it, est. speed input: 45.21 toks/s, output: 229.64 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.01s/it, est. speed input: 50.14 toks/s, output: 290.90 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.30s/it, est. speed input: 38.73 toks/s, output: 329.77 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.34s/it, est. speed input: 37.67 toks/s, output: 331.59 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.51s/it, est. speed input: 33.47 toks/s, output: 269.06 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.16s/it, est. speed input: 43.38 toks/s, output: 297.63 toks/s]
Dataset checkpoint saved after batch 61.████████████████████████| 2/2 [00:02<00:00,  1.12s/it, est. speed input: 43.38 toks/s, output: 297.63 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.15s/it, est. speed input: 59.47 toks/s, output: 323.16 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.19s/it, est. speed input: 58.38 toks/s, output: 316.54 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.09s/it, est. speed input: 61.16 toks/s, output: 347.87 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.81s/it, est. speed input: 70.88 toks/s, output: 350.79 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  2.00s/it, est. speed input: 64.16 toks/s, output: 333.83 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.75s/it, est. speed input: 46.50 toks/s, output: 301.34 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.10s/it, est. speed input: 60.85 toks/s, output: 353.90 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.49s/it, est. speed input: 66.25 toks/s, output: 329.59 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.12s/it, est. speed input: 46.48 toks/s, output: 355.10 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.15s/it, est. speed input: 45.85 toks/s, output: 364.00 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.59s/it, est. speed input: 27.44 toks/s, output: 222.99 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.50s/it, est. speed input: 21.91 toks/s, output: 220.65 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.68s/it, est. speed input: 58.80 toks/s, output: 275.50 toks/s]
Processed prompts: 100%|█████████████████████████████████████████| 2/2 [00:20<00:00, 10.37s/it, est. speed input: 9.50 toks/s, output: 251.50 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.01s/it, est. speed input: 29.61 toks/s, output: 345.16 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.52s/it, est. speed input: 25.28 toks/s, output: 285.42 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:09<00:00,  4.88s/it, est. speed input: 18.22 toks/s, output: 291.80 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  2.00s/it, est. speed input: 44.53 toks/s, output: 361.46 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.22s/it, est. speed input: 27.68 toks/s, output: 320.67 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.60s/it, est. speed input: 34.19 toks/s, output: 351.09 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.31s/it, est. speed input: 26.90 toks/s, output: 291.04 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.92s/it, est. speed input: 43.70 toks/s, output: 356.37 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.55s/it, est. speed input: 54.04 toks/s, output: 344.82 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.87s/it, est. speed input: 44.81 toks/s, output: 361.15 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.75s/it, est. speed input: 47.96 toks/s, output: 277.46 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.14s/it, est. speed input: 39.23 toks/s, output: 336.75 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.95s/it, est. speed input: 43.00 toks/s, output: 343.74 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.75s/it, est. speed input: 48.00 toks/s, output: 350.58 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.28s/it, est. speed input: 39.29 toks/s, output: 306.38 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.50s/it, est. speed input: 35.86 toks/s, output: 321.91 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.10s/it, est. speed input: 28.86 toks/s, output: 318.74 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.38s/it, est. speed input: 37.66 toks/s, output: 350.09 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.22s/it, est. speed input: 27.80 toks/s, output: 321.50 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.21s/it, est. speed input: 27.90 toks/s, output: 325.44 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.85s/it, est. speed input: 31.38 toks/s, output: 321.36 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 2/2 [00:03<00:00,  1.89s/it, est. speed input: 103.17 toks/s, output: 357.77 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.20s/it, est. speed input: 60.87 toks/s, output: 292.75 toks/s]
Processed prompts: 100%|███████████████████████████████████████| 2/2 [00:03<00:00,  1.58s/it, est. speed input: 122.73 toks/s, output: 332.84 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.77s/it, est. speed input: 70.24 toks/s, output: 331.33 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.45s/it, est. speed input: 79.54 toks/s, output: 277.69 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.48s/it, est. speed input: 55.84 toks/s, output: 293.69 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.08s/it, est. speed input: 93.40 toks/s, output: 304.68 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.88s/it, est. speed input: 44.45 toks/s, output: 290.31 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:20<00:00, 10.05s/it, est. speed input: 12.74 toks/s, output: 222.12 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.14s/it, est. speed input: 40.81 toks/s, output: 276.75 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.89s/it, est. speed input: 32.93 toks/s, output: 246.22 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.09s/it, est. speed input: 61.12 toks/s, output: 324.46 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.44s/it, est. speed input: 52.49 toks/s, output: 294.05 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.80s/it, est. speed input: 33.67 toks/s, output: 248.34 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.76s/it, est. speed input: 29.40 toks/s, output: 288.51 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.92s/it, est. speed input: 42.10 toks/s, output: 342.76 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.18s/it, est. speed input: 37.20 toks/s, output: 330.18 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.69s/it, est. speed input: 47.90 toks/s, output: 357.75 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.81s/it, est. speed input: 44.78 toks/s, output: 295.77 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.45s/it, est. speed input: 33.08 toks/s, output: 294.88 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.74s/it, est. speed input: 46.45 toks/s, output: 361.01 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.97s/it, est. speed input: 23.67 toks/s, output: 279.41 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.17s/it, est. speed input: 29.63 toks/s, output: 322.51 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.15s/it, est. speed input: 29.81 toks/s, output: 298.14 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.32s/it, est. speed input: 40.50 toks/s, output: 337.16 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.20s/it, est. speed input: 42.82 toks/s, output: 319.77 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.59s/it, est. speed input: 26.19 toks/s, output: 305.91 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.97s/it, est. speed input: 31.61 toks/s, output: 339.18 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.10s/it, est. speed input: 17.44 toks/s, output: 280.66 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  3.00s/it, est. speed input: 23.84 toks/s, output: 288.97 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.06s/it, est. speed input: 23.34 toks/s, output: 270.63 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.42s/it, est. speed input: 20.92 toks/s, output: 282.49 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.41s/it, est. speed input: 16.21 toks/s, output: 242.66 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.77s/it, est. speed input: 18.94 toks/s, output: 281.21 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.21s/it, est. speed input: 17.00 toks/s, output: 273.47 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.22s/it, est. speed input: 36.46 toks/s, output: 326.81 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.57s/it, est. speed input: 31.53 toks/s, output: 301.66 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.36s/it, est. speed input: 34.38 toks/s, output: 306.04 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.24s/it, est. speed input: 36.15 toks/s, output: 304.39 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.80s/it, est. speed input: 28.98 toks/s, output: 288.36 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.26s/it, est. speed input: 35.85 toks/s, output: 304.04 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.48s/it, est. speed input: 23.29 toks/s, output: 264.53 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.84s/it, est. speed input: 56.92 toks/s, output: 354.82 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.05s/it, est. speed input: 51.18 toks/s, output: 305.16 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.12s/it, est. speed input: 25.46 toks/s, output: 242.27 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.82s/it, est. speed input: 27.49 toks/s, output: 237.48 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.15s/it, est. speed input: 48.95 toks/s, output: 264.31 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.31s/it, est. speed input: 31.75 toks/s, output: 265.68 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.08s/it, est. speed input: 34.14 toks/s, output: 255.08 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.40s/it, est. speed input: 43.83 toks/s, output: 257.55 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:09<00:00,  4.54s/it, est. speed input: 42.50 toks/s, output: 254.57 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.81s/it, est. speed input: 50.69 toks/s, output: 294.58 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.28s/it, est. speed input: 58.91 toks/s, output: 273.95 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.25s/it, est. speed input: 45.38 toks/s, output: 263.70 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:11<00:00,  5.85s/it, est. speed input: 32.97 toks/s, output: 256.29 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.45s/it, est. speed input: 56.02 toks/s, output: 271.38 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.34s/it, est. speed input: 16.90 toks/s, output: 289.77 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.66s/it, est. speed input: 33.99 toks/s, output: 347.44 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.55s/it, est. speed input: 36.35 toks/s, output: 345.46 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.27s/it, est. speed input: 24.91 toks/s, output: 324.30 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.89s/it, est. speed input: 14.53 toks/s, output: 270.18 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.62s/it, est. speed input: 15.61 toks/s, output: 273.99 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.93s/it, est. speed input: 29.26 toks/s, output: 342.62 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.06s/it, est. speed input: 41.82 toks/s, output: 280.58 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.35s/it, est. speed input: 36.62 toks/s, output: 281.02 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.92s/it, est. speed input: 44.75 toks/s, output: 290.85 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.26s/it, est. speed input: 68.49 toks/s, output: 339.25 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.10s/it, est. speed input: 40.95 toks/s, output: 299.01 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.66s/it, est. speed input: 32.32 toks/s, output: 267.98 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.79s/it, est. speed input: 47.96 toks/s, output: 289.45 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.73s/it, est. speed input: 62.69 toks/s, output: 287.44 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.15s/it, est. speed input: 50.35 toks/s, output: 275.44 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.62s/it, est. speed input: 67.12 toks/s, output: 314.24 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.14s/it, est. speed input: 34.60 toks/s, output: 291.59 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.80s/it, est. speed input: 38.71 toks/s, output: 262.57 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.27s/it, est. speed input: 33.16 toks/s, output: 303.44 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.80s/it, est. speed input: 60.27 toks/s, output: 347.18 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.43s/it, est. speed input: 55.60 toks/s, output: 283.92 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.49s/it, est. speed input: 53.49 toks/s, output: 302.10 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.41s/it, est. speed input: 56.21 toks/s, output: 284.91 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.49s/it, est. speed input: 53.27 toks/s, output: 323.95 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.33s/it, est. speed input: 59.68 toks/s, output: 279.61 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.41s/it, est. speed input: 56.57 toks/s, output: 261.14 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.36s/it, est. speed input: 58.58 toks/s, output: 281.84 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.40s/it, est. speed input: 37.53 toks/s, output: 337.07 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.19s/it, est. speed input: 39.98 toks/s, output: 356.21 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.18s/it, est. speed input: 40.08 toks/s, output: 328.36 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.03s/it, est. speed input: 42.01 toks/s, output: 313.86 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.14s/it, est. speed input: 40.64 toks/s, output: 342.49 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.96s/it, est. speed input: 43.14 toks/s, output: 335.95 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.68s/it, est. speed input: 34.68 toks/s, output: 331.99 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:20<00:00, 10.01s/it, est. speed input: 13.03 toks/s, output: 222.71 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:19<00:00,  9.99s/it, est. speed input: 13.06 toks/s, output: 216.04 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:19<00:00,  9.97s/it, est. speed input: 13.08 toks/s, output: 216.07 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:20<00:00, 10.06s/it, est. speed input: 12.97 toks/s, output: 232.15 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:20<00:00, 10.02s/it, est. speed input: 13.02 toks/s, output: 224.90 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.98s/it, est. speed input: 65.76 toks/s, output: 346.93 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:20<00:00, 10.14s/it, est. speed input: 12.87 toks/s, output: 246.54 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.11s/it, est. speed input: 60.78 toks/s, output: 302.94 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.62s/it, est. speed input: 49.03 toks/s, output: 347.23 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.51s/it, est. speed input: 51.23 toks/s, output: 316.33 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.35s/it, est. speed input: 54.79 toks/s, output: 298.27 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.33s/it, est. speed input: 55.14 toks/s, output: 348.86 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.31s/it, est. speed input: 55.54 toks/s, output: 338.85 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.62s/it, est. speed input: 49.08 toks/s, output: 330.17 toks/s]
Dataset checkpoint saved after batch 81.████████████████████████| 2/2 [00:05<00:00,  2.35s/it, est. speed input: 49.08 toks/s, output: 330.17 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.36s/it, est. speed input: 26.53 toks/s, output: 308.48 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.50s/it, est. speed input: 25.40 toks/s, output: 297.86 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  3.00s/it, est. speed input: 29.68 toks/s, output: 330.18 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.94s/it, est. speed input: 22.57 toks/s, output: 297.86 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.71s/it, est. speed input: 32.89 toks/s, output: 345.70 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.44s/it, est. speed input: 20.05 toks/s, output: 309.05 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.60s/it, est. speed input: 24.75 toks/s, output: 326.18 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.74s/it, est. speed input: 27.79 toks/s, output: 309.85 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.01s/it, est. speed input: 25.28 toks/s, output: 357.43 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.20s/it, est. speed input: 18.09 toks/s, output: 295.34 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.63s/it, est. speed input: 28.87 toks/s, output: 290.01 toks/s]
Processed prompts: 100%|█████████████████████████████████████████| 2/2 [00:20<00:00, 10.22s/it, est. speed input: 7.43 toks/s, output: 231.21 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.51s/it, est. speed input: 30.29 toks/s, output: 310.49 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.61s/it, est. speed input: 21.08 toks/s, output: 311.98 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.74s/it, est. speed input: 33.58 toks/s, output: 245.83 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.84s/it, est. speed input: 49.89 toks/s, output: 323.71 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.12s/it, est. speed input: 81.81 toks/s, output: 344.57 toks/s]
Processed prompts: 100%|█████████████████████████████████████████| 2/2 [00:20<00:00, 10.09s/it, est. speed input: 9.12 toks/s, output: 220.06 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.01s/it, est. speed input: 45.72 toks/s, output: 305.13 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.73s/it, est. speed input: 53.11 toks/s, output: 323.54 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.86s/it, est. speed input: 49.56 toks/s, output: 304.92 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.56s/it, est. speed input: 44.52 toks/s, output: 343.08 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.34s/it, est. speed input: 47.42 toks/s, output: 318.35 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.81s/it, est. speed input: 56.46 toks/s, output: 284.42 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.59s/it, est. speed input: 44.18 toks/s, output: 323.44 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.65s/it, est. speed input: 59.79 toks/s, output: 307.44 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.24s/it, est. speed input: 48.89 toks/s, output: 311.71 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.67s/it, est. speed input: 59.40 toks/s, output: 299.44 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.49s/it, est. speed input: 25.29 toks/s, output: 319.70 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.78s/it, est. speed input: 22.68 toks/s, output: 256.55 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.81s/it, est. speed input: 22.45 toks/s, output: 298.31 toks/s]
Processed prompts: 100%|█████████████████████████████████████████| 2/2 [00:20<00:00, 10.22s/it, est. speed input: 6.16 toks/s, output: 230.79 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.89s/it, est. speed input: 33.31 toks/s, output: 324.35 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.58s/it, est. speed input: 39.84 toks/s, output: 324.42 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.17s/it, est. speed input: 28.99 toks/s, output: 301.82 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.24s/it, est. speed input: 46.80 toks/s, output: 238.44 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.74s/it, est. speed input: 33.40 toks/s, output: 225.19 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.01s/it, est. speed input: 19.27 toks/s, output: 236.73 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.17s/it, est. speed input: 18.32 toks/s, output: 221.16 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.34s/it, est. speed input: 43.27 toks/s, output: 243.98 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:01<00:00,  1.06it/s, est. speed input: 61.71 toks/s, output: 334.10 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.48s/it, est. speed input: 39.16 toks/s, output: 207.26 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.98s/it, est. speed input: 78.85 toks/s, output: 331.56 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.58s/it, est. speed input: 99.00 toks/s, output: 349.03 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.11s/it, est. speed input: 73.82 toks/s, output: 298.57 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.65s/it, est. speed input: 94.78 toks/s, output: 353.61 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.12s/it, est. speed input: 73.57 toks/s, output: 337.19 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.24s/it, est. speed input: 69.51 toks/s, output: 308.55 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.95s/it, est. speed input: 79.86 toks/s, output: 331.46 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.70s/it, est. speed input: 37.29 toks/s, output: 282.66 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.95s/it, est. speed input: 34.91 toks/s, output: 311.74 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.28s/it, est. speed input: 60.41 toks/s, output: 257.17 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:19<00:00,  9.89s/it, est. speed input: 13.96 toks/s, output: 243.09 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.28s/it, est. speed input: 60.47 toks/s, output: 267.29 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:11<00:00,  5.51s/it, est. speed input: 25.03 toks/s, output: 276.18 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.81s/it, est. speed input: 36.27 toks/s, output: 297.11 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.26s/it, est. speed input: 51.46 toks/s, output: 347.97 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.14s/it, est. speed input: 57.08 toks/s, output: 329.32 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.11s/it, est. speed input: 30.76 toks/s, output: 282.97 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.88s/it, est. speed input: 34.57 toks/s, output: 285.08 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.56s/it, est. speed input: 41.74 toks/s, output: 278.03 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.98s/it, est. speed input: 32.89 toks/s, output: 305.08 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.14s/it, est. speed input: 57.25 toks/s, output: 347.90 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.90s/it, est. speed input: 50.06 toks/s, output: 287.16 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.26s/it, est. speed input: 75.22 toks/s, output: 349.18 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.18s/it, est. speed input: 80.69 toks/s, output: 327.43 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.89s/it, est. speed input: 50.27 toks/s, output: 339.16 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.15s/it, est. speed input: 82.44 toks/s, output: 357.52 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.75s/it, est. speed input: 54.22 toks/s, output: 331.30 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.46s/it, est. speed input: 38.65 toks/s, output: 268.30 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.35s/it, est. speed input: 65.41 toks/s, output: 216.56 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.24s/it, est. speed input: 39.54 toks/s, output: 212.68 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.24s/it, est. speed input: 39.45 toks/s, output: 210.63 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.25s/it, est. speed input: 70.92 toks/s, output: 220.77 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:01<00:00,  1.05it/s, est. speed input: 92.61 toks/s, output: 225.51 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.50s/it, est. speed input: 58.89 toks/s, output: 218.91 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.40s/it, est. speed input: 63.03 toks/s, output: 217.93 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.06s/it, est. speed input: 42.89 toks/s, output: 359.62 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.03s/it, est. speed input: 43.60 toks/s, output: 346.08 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.07s/it, est. speed input: 42.68 toks/s, output: 363.63 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.14s/it, est. speed input: 41.31 toks/s, output: 344.49 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.39s/it, est. speed input: 37.05 toks/s, output: 314.64 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.04s/it, est. speed input: 43.47 toks/s, output: 348.49 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.26s/it, est. speed input: 39.08 toks/s, output: 312.68 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.21s/it, est. speed input: 42.21 toks/s, output: 247.08 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.35s/it, est. speed input: 37.87 toks/s, output: 255.09 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.20s/it, est. speed input: 42.52 toks/s, output: 257.64 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.59s/it, est. speed input: 32.17 toks/s, output: 237.51 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.27s/it, est. speed input: 40.29 toks/s, output: 267.80 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.17s/it, est. speed input: 43.52 toks/s, output: 246.60 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:01<00:00,  1.05it/s, est. speed input: 53.75 toks/s, output: 340.94 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.03s/it, est. speed input: 19.21 toks/s, output: 320.08 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.22s/it, est. speed input: 24.04 toks/s, output: 297.04 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.64s/it, est. speed input: 21.28 toks/s, output: 329.87 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:06<00:00,  3.38s/it, est. speed input: 22.95 toks/s, output: 336.88 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.66s/it, est. speed input: 21.19 toks/s, output: 335.56 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:10<00:00,  5.20s/it, est. speed input: 14.90 toks/s, output: 266.46 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.85s/it, est. speed input: 20.12 toks/s, output: 360.92 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.92s/it, est. speed input: 39.50 toks/s, output: 304.59 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.60s/it, est. speed input: 29.19 toks/s, output: 277.12 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.15s/it, est. speed input: 35.40 toks/s, output: 343.10 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:07<00:00,  3.71s/it, est. speed input: 20.51 toks/s, output: 240.73 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.09s/it, est. speed input: 36.30 toks/s, output: 344.59 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:09<00:00,  4.78s/it, est. speed input: 15.89 toks/s, output: 282.62 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.37s/it, est. speed input: 32.13 toks/s, output: 280.30 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.37s/it, est. speed input: 64.91 toks/s, output: 269.49 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:11<00:00,  5.74s/it, est. speed input: 15.50 toks/s, output: 247.82 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.44s/it, est. speed input: 36.52 toks/s, output: 307.99 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.32s/it, est. speed input: 67.60 toks/s, output: 278.76 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.78s/it, est. speed input: 49.95 toks/s, output: 328.57 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.52s/it, est. speed input: 58.38 toks/s, output: 249.28 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.88s/it, est. speed input: 47.29 toks/s, output: 343.76 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.72s/it, est. speed input: 54.73 toks/s, output: 250.92 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.52s/it, est. speed input: 61.88 toks/s, output: 355.80 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.48s/it, est. speed input: 63.55 toks/s, output: 293.07 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.88s/it, est. speed input: 49.87 toks/s, output: 246.97 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.62s/it, est. speed input: 57.93 toks/s, output: 264.98 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.76s/it, est. speed input: 53.50 toks/s, output: 266.94 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:02<00:00,  1.37s/it, est. speed input: 68.63 toks/s, output: 294.22 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.86s/it, est. speed input: 18.36 toks/s, output: 263.88 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.60s/it, est. speed input: 20.18 toks/s, output: 259.42 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.74s/it, est. speed input: 19.19 toks/s, output: 290.08 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.36s/it, est. speed input: 22.24 toks/s, output: 273.17 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:04<00:00,  2.33s/it, est. speed input: 22.50 toks/s, output: 278.14 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:03<00:00,  1.56s/it, est. speed input: 33.73 toks/s, output: 302.95 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.65s/it, est. speed input: 19.81 toks/s, output: 250.52 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:13<00:00,  6.82s/it, est. speed input: 10.56 toks/s, output: 244.05 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:11<00:00,  5.94s/it, est. speed input: 12.12 toks/s, output: 338.54 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:05<00:00,  2.90s/it, est. speed input: 24.83 toks/s, output: 347.67 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:09<00:00,  4.51s/it, est. speed input: 15.97 toks/s, output: 272.75 toks/s]
Processed prompts: 100%|█████████████████████████████████████████| 2/2 [00:20<00:00, 10.28s/it, est. speed input: 7.00 toks/s, output: 247.11 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:11<00:00,  5.70s/it, est. speed input: 12.64 toks/s, output: 313.89 toks/s]
Processed prompts: 100%|████████████████████████████████████████| 2/2 [00:08<00:00,  4.50s/it, est. speed input: 16.01 toks/s, output: 306.66 toks/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [1:04:24<00:00, 38.65s/it]
Final dataset saved. Checkpoint removed.
[rank0]:[W731 22:43:23.744974271 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
✅ ステップ3完了: 多様な解答生成が完了しました

[ステップ 4/4] ⭐ 解答品質評価
  → ArmoRM-Llama3-8Bモデルを使用して7つの解答候補を評価中...

⏳ 推定時間: 5-10分 (評価処理)
config.json: 1.03kB [00:00, 6.59MB/s]
modeling_custom.py: 7.52kB [00:00, 43.7MB/s]
A new version of the following files was downloaded from https://huggingface.co/RLHFlow/ArmoRM-Llama3-8B-v0.1:
- modeling_custom.py
. Make sure to double-check they do not contain any added malicious code. To avoid downloading new versions of the code file, you can pin a revision.
model.safetensors.index.json: 24.6kB [00:00, 150MB/s]
model-00004-of-00004.safetensors: 100%|███████████████████████████████████████████████████████████████████████████| 143M/143M [00:04<00:00, 30.7MB/s]
model-00001-of-00004.safetensors: 100%|█████████████████████████████████████████████████████████████████████████| 4.98G/4.98G [02:19<00:00, 35.7MB/s]
model-00002-of-00004.safetensors: 100%|█████████████████████████████████████████████████████████████████████████| 5.00G/5.00G [02:23<00:00, 34.9MB/s]
model-00003-of-00004.safetensors: 100%|█████████████████████████████████████████████████████████████████████████| 4.92G/4.92G [02:25<00:00, 33.7MB/s]
Fetching 4 files: 100%|████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [02:26<00:00, 36.59s/it]
Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:06<00:00,  1.66s/it]
tokenizer_config.json: 51.0kB [00:00, 178MB/s]██████████████████████████████████████████████████████████████████| 4.92G/4.92G [02:25<00:00, 33.6MB/s]
tokenizer.json: 9.08MB [00:00, 21.3MB/s]
special_tokens_map.json: 100%|██████████████████████████████████████████████████████████████████████████████████████| 439/439 [00:00<00:00, 96.9kB/s]
Total number of batches: 25
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:52<00:00,  2.09s/it]
✅ ステップ4完了: 解答品質評価が完了しました

📊 データセット情報を作成中...

🎉 データセット生成が完全に完了しました！
═══════════════════════════════════════════════════

📋 生成結果サマリー:
  分野: Statistics (ADVANCED STATISTICS - Measure-theoretic probability, advanced inference, martingales)
  問題数: 60問
  使用モデル: Qwen/Qwen2.5-3B-Instruct
  生成日時: 2025年07月31日 22:47:05

📁 生成されたファイル:
  📝 問題データ (最大1024トークン):
      ../data/Qwen2.5-3B-Instruct_statistics_20250731_212932/statistics_ins.json
  🎓 SFT学習データ (最大4096トークン):
      ../data/Qwen2.5-3B-Instruct_statistics_20250731_212932/statistics_ins_res.json
  🎯 嗜好学習データ (7候補+評価スコア):
      ../data/Qwen2.5-3B-Instruct_statistics_20250731_212932/statistics_ins_7res_armorm.json
  📊 データセット情報:
      ../data/Qwen2.5-3B-Instruct_statistics_20250731_212932/dataset_info.json

🚀 データセット名: Magpie-Statistics-ADVANCED-HLE-60
⚡ 高難度モード: 研究レベルの問題 (10-20ステップの推論チェーン)

💡 次のステップ:
  • SFT学習: statistics_ins_res.json を使用
  • 嗜好学習: statistics_ins_7res_armorm.json を使用
  • データ確認: dataset_info.json で詳細確認
═══════════════════════════════════════════════════
🔍 Searching for generated folder...
✅ Found valid folder: Qwen2.5-3B-Instruct_statistics_20250731_212932
mv: cannot move '../data/Qwen2.5-3B-Instruct_statistics_20250731_212932' to '../data/Qwen2.5-3B-Instruct_AllDomains_20250731_212932/statistics': No such file or directory
(magpie) [P12U022@osk-gpu85 scripts]$ em
(magpie) [P12U022@osk-gpu85 scripts]$